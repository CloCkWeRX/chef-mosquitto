allow_anonymous <%= node['mosquitto']['allow_anonymous'] %>
autosave_interval <%= node['mosquitto']['autosave_interval'] %>

connection_messages <%= node['mosquitto']['connection_messages'] %>
log_dest stderr
log_dest topic
log_type error
log_type warning
log_type notice
log_type information
log_type all
log_type debug
log_timestamp true

<% if node['mosquitto']['persistence'] %>
persistence <%= node['mosquitto']['persistence'] %>
persistence_location <%= node['mosquitto']['persistence_location'] %>
persistence_file <%= node['mosquitto']['persistence_file'] %>
persistent_client_expiration <%= node['mosquitto']['persistent_client_expiration'] %>
<% end %>

retained_persistence <%= node['mosquitto']['retained_persistence'] %>

<% node['mosquitto']['listeners'].each do |listener| %>
listener <%= [listener[:port], listener[:addr]].compact.join(" ") %>
<% end %>

<% if node['mosquitto']['tls_version'] %>
tls_version <%= node['mosquitto']['tls_version'] %>
cafile <%= node['mosquitto']['path'] %>/<%= node['mosquitto']['cafile'] %>
certfile <%= node['mosquitto']['path'] %>/<%= node['mosquitto']['certfile'] %>
keyfile <%= node['mosquitto']['path']%>/<%= node['mosquitto']['keyfile'] %>
<% end %>

require_certificate <%= node['mosquitto']['require_certificate'] %>